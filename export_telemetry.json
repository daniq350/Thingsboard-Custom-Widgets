{
  "alias": "export_telemetry",
  "name": "Export Telemetry",
  "image": "data:image/png;base64,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",
  "description": "Displays changes to timeseries data over time. For example, temperature or humidity readings.",
  "descriptor": {
    "type": "timeseries",
    "sizeX": 9.5,
    "sizeY": 5.5,
    "resources": [],
    "templateHtml": "<form #rpcForm=\"ngForm\" (submit)=\"sendCommand()\">\r\n      <div class=\"mat-content mat-padding\" fxLayout=\"column\">\r\n        <button  mat-raised-button color=\"primary\" type=\"submit\" >\r\n          {{buttonLable}}\r\n        </button>\r\n      </div>\r\n</form>\r\n<form #timeForm=\"ngForm\" >\r\n  <label for=\"starttime\">Start Time: </label>\r\n  <input type=\"datetime-local\" id=\"starttime\" name=\"starttime\">\r\n  \r\n</form>\r\n<form #endtimeForm=\"ngForm\" (submit)=\"sendTime()\" style=\"margin:10px; float:left;\">\r\n  <label for=\"endtime\">End Time: </label>\r\n  <input type=\"datetime-local\" id=\"endtime\" name=\"endtime\">\r\n  <input type=\"submit\" style=\"margin:10px;\" >\r\n</form>\r\n    \r\n<div class=\"btn-group\">\r\n</div>",
    "templateCss": "\n.mouse-events .flot-overlay {\n    cursor: crosshair; \n}\n\n.tb-rpc-button {\n    width: 100%;\n    height: 100%;\n   \n}\n\n.tb-rpc-button .title-container {\n    font-weight: 500;\n    white-space: nowrap;\n    margin: 10px 0;\n}\n\n.tb-rpc-button .button-container div{\n    min-width: 80%\n}\n\n.tb-rpc-button .button-container .mat-button{\n    width: 100%;\n    margin: 0;\n}\n\n.tb-rpc-button .error-container {\n    position: absolute;\n    top: 2%;\n    right: 0;\n    left: 0;\n    z-index: 4;\n    height: 14px;\n}\n\n.tb-rpc-button .error-container .button-error {\n    color: white;\n    white-space: nowrap;\n}\n\n.btn-group button {\n  background-color: #6B7B8C; /* Green background */\n  border: 4px solid white; /* Green border */\n  border-color: #98a3ae;\n  color: black; /* White text */\n  padding: 10px 12px; /* Some padding */\n  cursor: pointer; /* Pointer/hand icon */\n  float: left; /* Float the buttons side by side */\n  \n}\n\n/* Clear floats (clearfix hack) */\n.btn-group:after {\n  content: \"\";\n  clear: both;\n  display: table;\n}\n\n.btn-group button:not(:last-child) {\n  border-right: none; /* Prevent double borders */\n}\n\n/* Add a background color on hover */\n.btn-group button:hover {\n  background-color: #001aff;\n  color: white;\n}\n\n table, th, td{\n        border: 1px solid #cdcdcd;\n        \n    }\ntable, tbody{\n    display: block;\n    height: 500px;\n    width:100%;\n    overflow: auto;\n}",
    "controllerScript": "var selected_entity=0;\nvar selected=[];\nvar ds;\nvar j=0;\nvar telemetry_keys=[];\nvar telemetrystr=\"\";\nvar table,classname;\nvar mintime, maxtime;\n\nself.onInit = function() {\n    \nconsole.log(self.ctx);\nself.ctx.$scope.buttonLable = self.ctx.settings.buttonText;  \n//services \nlet $injector = self.ctx.$scope.$injector;\nlet attributeService = $injector.get(self.ctx.servicesMap.get('attributeService'));\n   \n  \n//List Entities Table\nvar tbDatasource = self.ctx.datasources[0];\nvar datasourceId = 'tbDatasource' + i+'export';\n\nself.ctx.$container.append(\n    \"<div  id='\" + datasourceId +\n    \"' class='tbDatasource-container' ></div>\"\n);\n\nvar datasourceContainer = $('#' + datasourceId,\n            self.ctx.$container);\n  \n//datetime picker\n\n     \n//drop down entity list \nvar selectId = 'select' + 0+'export';\n\ndatasourceContainer.append(\n\"<select id='\" + selectId +\n\"' style='width=50%;height=50%;display:block;margin:15px' ></select>\"\n);\n\nvar select= $('#' + selectId, self.ctx.$container);\nfor (var i=0; i < self.ctx.datasources.length; i++) {\n    select.append(\"<option>\" + self.ctx.datasources[i]['entityName'] +\n            \"</option>\");\n }\n \n//telemetry table \nvar tableId = 'table' + 0+'export';\n\ndatasourceContainer.append(\n\"<div style=' width:100%;height:50%;'><table id='\" + tableId +\n\"' class='tbDatasource-table' style='display: inline-block;float: left; '><col width='30%' ></table></div>\"\n);\n\ntable = $('#' + tableId, self.ctx.$container);\nclassname='boxes'+tbDatasource['entityId']+'export';\ngetKeys();\n\nfunction getKeys(){\n    \n    ds=self.ctx.datasources[selected_entity];\n     self.ctx.http.get('/api/plugins/telemetry/'+ds['entityType']+'/'+ds['entityId']+'/keys/timeseries').subscribe(function (response) {\n         \n         telemetry_keys=response;\n         \n         updateTable();\n         \n     });\n}\n\nfunction getTimeseries(){\n\n    if (telemetry_keys!=0 && (!isNaN(mintime) && !isNaN(maxtime))){\n telemetrystr=selected.toString();       \nds=self.ctx.datasources[selected_entity];\nself.ctx.http.get('/api/plugins/telemetry/'+ds['entityType']+'/'+ds['entityId']+'/values/timeseries?keys='+telemetrystr+'&startTs='+mintime+'&endTs='+maxtime+'&limit=5000&orderBy=ASC&useStrictDataTypes=true').subscribe(function (response) {\nconsole.log(response);\nif (Object.keys(response).length === 0){\n    alert('No Data in specified Time Range');\n}\nelse{\n    alert('Downloading Data');\n}\nvar data=response;\nvar shift_data;\nvar shift_data_array=[];\nvar data_name;\nvar keys=Object.keys(data);\n\nfor (var i=0;i<keys.length;i++){\n    shift_data=data[keys[i]];\n    data_name=keys[i];\n    shift_data_array=[];\n     for (var j=0;j<shift_data.length;j++){\n         shift_data_array.push(Object.values(shift_data[j]))\n         shift_data_array[j][0]=convertEpochToSpecificTimezone(shift_data_array[j][0],+0);\n         \n    }\n    var rows=shift_data_array;\n    rows.unshift([\"Timestamp\",data_name]);\n    let csvContent = \"data:text/csv;charset=utf-8,\";\n\n rows.forEach(function(rowArray) {\n    let row = rowArray.join(\",\");\n    csvContent += row + \"\\r\\n\";\n});\n\nvar encodedUri = encodeURI(csvContent);\nwindow.open(encodedUri);\n\nvar encodedUri = encodeURI(csvContent);\nvar link = document.createElement(\"a\");\nlink.setAttribute(\"href\", encodedUri);\nlink.setAttribute(\"download\", ds['entityName']+'_'+data_name+\".csv\");\ndocument.body.appendChild(link); // Required for FF\n\nlink.click();\n    \n}\n         \n     });\n}\nelse{\n    alert(\"Please check if Telemetry key and DateTime is selected\");\n}\n}\n\nfunction convertEpochToSpecificTimezone(timeEpoch, offset){\n    var d = new Date(timeEpoch);\n    var utc = d.getTime() + (d.getTimezoneOffset() * 60000);  //This converts to UTC 00:00\n    var nd = new Date(utc + (3600000*offset));\n    var utciso= new Date(timeEpoch).toISOString();\n    return utciso;\n   \n}\n\nfunction updateTable(){\n  table.empty();\n  table.append(\"<thead><tr style='background-color:#A9A9A9;'><th><input type='checkbox' id='allcb' name='allcb' /></th><th style='color:black;'>Telemetry</th></tr></thead>\");\n\nvar tbodyId = 'tbody' + 0+'export';\ntable.append(\"<tbody   id='\" + tbodyId +\"'></tbody>\");\ntbody = $('#' + tbodyId, self.ctx.$container);\n\n for (var i=0; i < telemetry_keys.length; i++) {\n      var cb='cb'+i;\n     tbody.append(\"<tr>\");\n     tbody.append(\"<td><input type='checkbox' class='\" + classname +\n            \"' id='\" + cb +\n            \"' name=''\" + cb +\n            \"' /></td>\");\n    tbody.append(\"<td >\" + telemetry_keys[i] +\"</td>\");\n    tbody.append(\"</tr>\");\n }\n \n //all checkbox\n$('#allcb').change(function () {\n    console.log(\"test\");\n    $('tr td input[type=\"checkbox\"]').prop('checked', $(this).prop('checked'));\n});\n\n//individual select\n\n$('.'+classname).change(function () {\n    console.log('change');\n    var ischecked= $(this).is(':checked');\n    var id=this.id;\n    var index=parseInt(id.substring(id.indexOf('b') + 1));\n     if (ischecked){\n         selected.push(telemetry_keys[index]);\n         console.log(selected);\n     }\n     else{\n        \n         if (index !== -1) {\n            selected.splice(index, 1);\n         }\n         console.log('removed');\n         console.log(selected);\n     }\n   \n});\n     \n }\n\n//dropdown event\n$('#select0export').change(function () {\n    selected_entity=$( \"#select0export option:selected\" ).index();\n    selected=[];\n    getKeys();\n});\n\n\n \nself.ctx.$scope.sendTime = function() {\n\nvar starttime = $(\"#starttime\").val();\nvar endtime = $(\"#endtime\").val();\n\nmintime = +new Date(starttime);\nmaxtime =+ new Date(endtime);\nif (isNaN(mintime) || isNaN(maxtime)){\n    alert(\"Please Select Time and Date!\");\n}\nelse{\n    console.log(mintime,maxtime);\n}\n\n\n\n\n}\n\nself.ctx.$scope.sendCommand = function() {\n         getTimeseries();\n}\n\n\n\n}\n\n\nself.onDataUpdated = function() {\n   \n}\n\nself.onResize = function() {\n    \n}\n\nself.onEditModeChanged = function() {\n    \n}\n\n\n\nself.onDestroy = function() {\n    \n}\n",
    "settingsSchema": "{\n    \"schema\": {\n        \"type\": \"object\",\n        \"title\": \"Settings\",\n        \"properties\": {\n            \"buttonText\": {\n                \"title\": \"Button label\",\n                \"type\": \"string\",\n                \"default\": \"Start Scan\"\n            },\n            \"required\": []\n        }\n    },\n    \"form\": [\n        \n        \"buttonText\"\n    ]\n\n}",
    "dataKeySettingsSchema": "{}",
    "defaultConfig": "{\"datasources\":[{\"type\":\"function\",\"name\":\"function\",\"entityAliasId\":null,\"filterId\":null,\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"First\",\"color\":\"#2196f3\",\"settings\":{\"showLines\":true,\"fillLines\":true,\"showPoints\":false},\"_hash\":0.8587686344902596,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Second\",\"color\":\"#ffc107\",\"settings\":{\"showLines\":true,\"fillLines\":false,\"showPoints\":false},\"_hash\":0.12775350966079668,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"},{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Random\",\"color\":\"#f44336\",\"settings\":{},\"_hash\":0.11310555016241075,\"funcBody\":\"var value = prevValue + Math.random() * 100 - 50;\\nvar multiplier = Math.pow(10, 2 || 0);\\nvar value = Math.round(value * multiplier) / multiplier;\\nif (value < -1000) {\\n\\tvalue = -1000;\\n} else if (value > 1000) {\\n\\tvalue = 1000;\\n}\\nreturn value;\"}]},{\"type\":\"function\",\"name\":\"function\",\"entityAliasId\":null,\"filterId\":null,\"dataKeys\":[{\"name\":\"f(x)\",\"type\":\"function\",\"label\":\"Sin\",\"color\":\"#ffc107\",\"settings\":{},\"_hash\":0.5368083900852447,\"funcBody\":\"return Math.round(1000*Math.sin(time/5000));\"}]}],\"timewindow\":{\"hideInterval\":false,\"hideAggregation\":true,\"hideAggInterval\":true,\"hideTimezone\":true,\"selectedTab\":1,\"history\":{\"historyType\":1,\"timewindowMs\":60000,\"interval\":300000,\"fixedTimewindow\":{\"startTimeMs\":1658302171269,\"endTimeMs\":1658388571269},\"quickInterval\":\"CURRENT_DAY\"},\"aggregation\":{\"type\":\"AVG\",\"limit\":25000}},\"showTitle\":true,\"backgroundColor\":\"#fff\",\"color\":\"rgba(0, 0, 0, 0.87)\",\"padding\":\"8px\",\"settings\":{\"buttonText\":\"Export Telemetry\"},\"title\":\"Export Telemetry\",\"dropShadow\":true,\"enableFullscreen\":false,\"titleStyle\":{\"fontSize\":\"16px\",\"fontWeight\":400},\"mobileHeight\":null,\"actions\":{\"headerButton\":[]},\"useDashboardTimewindow\":true,\"displayTimewindow\":true,\"showTitleIcon\":false,\"titleTooltip\":\"\",\"widgetStyle\":{},\"widgetCss\":\"\",\"noDataDisplayMessage\":\"\",\"showLegend\":false}"
  }
}